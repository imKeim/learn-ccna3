<!-- 5.1.1 -->
## Создание списка управления доступом (ACL)
В предыдущем модуле вы узнали о том, что делает ACL и почему это важно. В этом разделе вы узнаете о создании списков ACL.

Все списки управления доступом (ACL) должны быть запланированы. Однако это особенно справедливо для списков ACL, требующих нескольких записей управления доступом (ACE).

При настройке сложного списка ACL рекомендуется:

* Используйте текстовый редактор и выпишите определенную политику, которая будет реализована.
* Добавьте команды конфигурации IOS для выполнения этих задач.
* Включить комментарии для документирования списка ACL.
* Скопируйте и вставьте команды на устройство.
* Всегда тщательно тестируйте ACL, чтобы убедиться, что он правильно применяет требуемую политику.

Эти рекомендации позволяют создавать ACL продуманно, не влияя на трафик в сети.

<!-- 5.1.2 -->
## Синтаксис стандартного нумерованного списка контроля доступа (ACL) IPv4
Чтобы создать нумерованный стандартный список ACL, используйте следующую команду глобальной конфигурации:

```
Router(config)# access-list access-list-number {deny | permit | remark text} source [source-wildcard] [log]
```
Используйте команду глобальной конфигурации **no access-list** *access-list-number*, чтобы удалить нумерованный стандартный список ACL.

Таблица содержит подробное описание синтаксиса для стандартного ACL-списка.

| **Параметр** | **Описание** |
| --- | --- |
| *access-list-number* | <ul><li>Это десятичное число ACL. </li><li>Стандартный диапазон номеров ACL — от 1 до 99 и от 1300 до 1999.</li></ul> |
| **deny** | Запрещает доступ при совпадении условий. |
| **permit** | Разрешает доступ при совпадении условий. |
| **remark** *text* | <ul><li>(Необязательно) Добавляет текстовую запись для целей документации.</li><li>Длина комментария ограничена 100 символами.</li></ul> |
| *source* | <ul><li>Определяет исходный адрес сети или узла для фильтрации.</li><li>Используйте ключевое слово **any** для определения всех сетей.</li><li>Используйте ключевое слово **host** *ip-address* или просто введите *ip-адрес* (без ключевого слова **host**) для идентификации конкретного IP-адреса.</li></ul> |
| *source-wildcard* | (Опционально). 32-битная шаблонная маска должна применяться к адресу *источника*.<br>Если этот параметр опущен, по умолчанию принимается маска 0.0.0.0. |
| **log** | <ul><li>(Необязательно) Это ключевое слово генерирует и отправляет информационное сообщение всякий раз, когда ACE совпадает с пакетом.</li><li>Сообщение включает номер ACL, совпадающее условие (то есть, permit или deny), адрес источника и количество пакетов.</li><li>Сообщение генерируется для первого совпадающего пакета.</li><li>Это ключевое слово должно быть реализовано только для устранения неполадок или обеспечения безопасности сети.</li></ul> |

<!-- 5.1.3 -->
## Синтаксис стандартного именованного списка контроля доступа (ACL) IPv4
Присвоение имен ACL-спискам упрощает понимание функции того или иного списка. Чтобы создать именованный стандартный список ACL, используйте следующую команду глобальной конфигурации:

```
Router(config)# ip access-list standard access-list-name
```

Эта команда входит в именованный стандартный режим конфигурации, в котором настраиваются списки ACL.

Имена ACL-списков состоят из буквенно-цифровых символов, они чувствительны к регистру и должны быть уникальными. Указывать имена ACL-списков заглавными буквами не обязательно, но это делает их более заметными при просмотре выходных данных текущей конфигурации. Это также снижает вероятность случайного создания двух разных ACL-списков с одинаковыми именами, но различающимися использованием заглавных и строчных букв.

**Примечание:** используйте команду глобальной конфигурации **no ip access-list standard** *access-list-name* для удаления именованного стандартного ACL IPv4.

В этом примере создается именованный стандартный ACL IPv4 с именем NO-ACCESS. Обратите внимание, что запрос изменяется на именованный стандартный режим конфигурации ACL. Оператора ACE вводятся в именованном стандартном режиме конфигурации ACL. Используйте справку для просмотра всех именованных стандартных параметров ACE ACL.

Три выделенных параметра настроены аналогично нумерованному стандартному ACL. В отличие от метода нумерованного ACL, нет необходимости повторять начальную команду **ip access-list** для каждого ACE.

```
R1(config)# ip access-list standard NO-ACCESS
R1(config-std-nacl)# ?
Standard Access List configuration commands:
  <1-2147483647>  Sequence Number
  default         Set a command to its defaults
  deny            Specify packets to reject
  exit            Exit from access-list configuration mode
  no              Negate a command or set its defaults
  permit          Specify packets to forward
  remark          Access list entry comment
R1(config-std-nacl)#
```

<!-- 5.1.4 -->
## Применение стандартного списка контроля доступа IPv4
После настройки стандартного списка ACL IPv4 он должен быть связан с интерфейсом или сервисом. Следующая команда может быть использована для привязки нумерованного или именованного стандартного ACL IPv4 к интерфейсу:

```
Router(config-if) # ip access-group {access-list-number | access-list-name} {in | out}
```

Чтобы удалить список ACL из интерфейса, сначала введите команду конфигурации интерфейса **no ip access-group**. Однако ACL по-прежнему будет настроен на маршрутизаторе. Чтобы удалить список ACL с маршрутизатора, используйте команду глобальной конфигурации **no access-list**.
<!-- 5.1.5 -->
## Примеры стандартного нумерованного списка контроля доступа (ACL) IPv4
Топология на рисунке будет использоваться для демонстрации настройки и применения нумерованных и именованных стандартных списков ACL IPv4 к интерфейсу. В этом первом примере показана реализация стандартного списка ACL IPv4 с нумерацией.

![](./assets/5.1.5.png)
<!-- /courses/ensa-dl/ae8e8c84-34fd-11eb-ba19-f1886492e0e4/aeb43cf8-34fd-11eb-ba19-f1886492e0e4/assets/c618bd60-1c46-11ea-af56-e368b99e9723.svg -->

<!--
которая используется несколько раз в этом модуле. Отображает маршрутизатор R1 с 3 сетевыми интерфейсами: S0/1/0 подключен к Интернету и будет иметь список доступа, примененный к нему в исходящем направлении, G0/0/0 подключен к коммутатору LAN 1, а G0/0/1 подключен к коммутатору LAN 2
-->

Предположим, что доступ в Интернет разрешен только PC1. Чтобы включить эту политику, стандартный ACL ACE может быть применен исходящий на S0/1/0, как показано на рисунке.

```
R1(config)# access-list 10 remark ACE permits ONLY host 192.168.10.10 to the internet
R1(config)# access-list 10 permit host 192.168.10.10
R1(config)# do show access-lists
Standard IP access list 10
    10 permit 192.168.10.10
R1(config)#
```

Обратите внимание, что выходные данные команды **show access-lists** не отображают инструкции **remark**. Комментарии ACL отображаются в файле текущей конфигурации. Хотя эта команда **remark** не требуется для включения списка управления доступом, она настоятельно рекомендуется для целей документации.

Теперь предположим, что новая политика сети гласит, что узлы в локальной сети 2 также должны быть разрешены кна доступ к Интернету. Чтобы включить эту политику, в список ACL 10 можно добавить вторую запись в стандартный ACL, как показано в выходных данных.

```
R1(config)# access-list 10 remark ACE permits all host in LAN 2
R1(config)# access-list 10 permit 192.168.20.0 0.0.0.255
R1(config)# do show access-lists
Standard IP access list 10
    10 permit 192.168.10.10
    20 permit 192.168.20.0, wildcard bits 0.0.0.255
R1(config)#
```

Apply ACL 10 outbound on the Serial 0/1/0 interface.

```
R1(config)# interface Serial 0/1/0
R1(config-if)# ip access-group 10 out
R1(config-if)# end
R1#
```

Результирующая политика ACL 10 разрешает только узлу 192.168.10.10 и всем узлам из LAN 2 выходить из интерфейса Serial 0/1/0. Все остальные узлы в сети 192.168.10.0 не будут допущены в Интернет.

Используйте эту команду **show running-config** для просмотра списка ACL в конфигурации, как показано в выходных данных.

```
R1# show run | section access-list
access-list 10 remark ACE permits host 192.168.10.10
access-list 10 permit 192.168.10.10
access-list 10 remark ACE permits all host in LAN 2
access-list 10 permit 192.168.20.0 0.0.0.255
R1#
```

Обратите внимание на то, как также отображаются инструкции **remarks**.

Наконец, используйте команду **show ip interface**, чтобы проверить, применяется ли к интерфейсу ACL. В выходных данных примера выходные данные специально просматривают интерфейс Serial 0/1/0 для строк, которые содержат текст «access list».

```
R1# show ip int Serial 0/1/0 | include access list
  Outgoing Common access list is not set
  Outgoing access list is 10
  Inbound Common access list is not set
  Inbound  access list is not set
R1#
```

<!-- 5.1.6 -->
## Примеры стандартного именованоого списка контроля доступа (ACL) IPv4
Во втором примере показана именованная реализация стандартного ACL для IPv4. Топология повторяется на рисунке для вашего удобства.

![](./assets/5.1.6.png)
<!-- /courses/ensa-dl/ae8e8c84-34fd-11eb-ba19-f1886492e0e4/aeb43cf8-34fd-11eb-ba19-f1886492e0e4/assets/c61a6b11-1c46-11ea-af56-e368b99e9723.svg -->

<!--
топология из части 5.1.5
-->

Предположим, что доступ в Интернет разрешен только PC1. Чтобы включить эту политику, именованный стандартный ACL PERMIT-ACCESS может быть применен к исходащему интерфейсу S0/1/0.

Удалите ранее настроенный ACL 10 и создайте именованный стандартный ACL с именем PERMIT-ACCESS, как показано здесь.

```
R1(config)# no access-list 10
R1(config)# ip access-list standard PERMIT-ACCESS
R1(config-std-nacl)# remark ACE permits host 192.168.10.10
R1(config-std-nacl)# permit host 192.168.10.10
R1(config-std-nacl)#
```

Теперь добавьте ACE, разрешающую только хост 192.168.10.10, и другую ACE, разрешающую все хосты LAN 2 в Интернет.

```
R1(config-std-nacl)# remark ACE permits host 192.168.10.10
R1(config-std-nacl)# permit host 192.168.10.10
R1(config-std-nacl)# remark ACE permits all hosts in LAN 2
R1(config-std-nacl)# permit 192.168.20.0 0.0.0.255
R1(config-std-nacl)# exit
R1(config)#
```

Примените новый именованный ACL к исходащему интерфейсу Serial 0/1/0.

```
R1(config)# interface Serial 0/1/0
R1(config-if)# ip access-group PERMIT-ACCESS out
R1(config-if)# end
R1#
```

Используйте команду **show access-lists** и **show running-config** для просмотра списка ACL в конфигурации, как показано в выходных данных.

```
R1# show access-lists
Standard IP access list PERMIT-ACCESS
    10 permit 192.168.10.10
    20 permit 192.168.20.0, wildcard bits 0.0.0.255
R1# show run | section ip access-list
ip access-list standard PERMIT-ACCESS
 remark ACE permits host 192.168.10.10
 permit 192.168.10.10
 remark ACE permits all hosts in LAN 2
 permit 192.168.20.0 0.0.0.255
R1#
```

Наконец, используйте команду **show ip interface**, чтобы проверить, применяется ли к интерфейсу ACL. В выходных данных примера выходные данные специально просматривают интерфейс Serial 0/1/0 для строк, которые содержат текст «access list».

```
R1# show ip int Serial 0/1/0 | include access list
  Outgoing Common access list is not set
  Outgoing access list is PERMIT-ACCESS
  Inbound Common access list is not set
  Inbound  access list is not set
R1#
```

<!-- 5.1.7 Проверка синтаксиса - настройка стандартных списков ACL IPv4
Настройте нумерованные и именованные списки ACL на R1.

![](./assets/5.1.7.PNG) здесь задание 5.1.7-->

<!-- 5.1.8 -->
## Packet Tracer. Настройка нумерованных стандартных списков контроля доступа для IPv4
Стандартные списки контроля доступа (ACL-списки) являются скриптами конфигурации маршрутизатора, которые разрешают или запрещают маршрутизатору пропускать пакеты, исходя из адреса источника. Данное интерактивное задание фокусируется на определении критериев фильтрации, настройке стандартных ACL-списков, применении их на интерфейсах маршрутизатора и проверке и тестировании реализации ACL-списка. Настройка маршрутизаторов, включая маршрутизацию EIGRP и назначение IPv4-адресов, уже выполнена.

[Настройка нумерованных стандартных списков контроля доступа для IPv4 (pdf)](./assets/5.1.8-packet-tracer---configure-numbered-standard-ipv4-acls_ru-RU.pdf)

[Настройка нумерованных стандартных списков контроля доступа для IPv4 (pka)](./assets/5.1.8-packet-tracer---configure-numbered-standard-ipv4-acls_ru-RU.pka)
<!-- 5.1.9 -->
## Packet Tracer. Настройка именованных стандартных списков контроля доступа (ACL) IPv4.
Старший сетевой администратор попросил вас создать стандартный именованный список контроля доступа (ACL) для запрета доступа к файловому серверу. Доступ должен быть запрещен всем клиентам одной сети и определенной рабочей станции другой сети.

[Настройка именованных стандартных списков контроля доступа (ACL) IPv4 (pdf)](./assets/5.1.9-packet-tracer---configure-named-standard-ipv4-acls_ru-RU.pdf)

[Настройка именованных стандартных списков контроля доступа (ACL) IPv4 (pka)](./assets/5.1.9-packet-tracer---configure-named-standard-ipv4-acls_ru-RU.pka)
