<!-- 4.1.1 -->
## Что такое ACL-список?

Маршрутизаторы принимают решения о маршрутизации на основе информации, содержащейся в заголовке пакета. Трафик, поступающий на маршрутизатор, основывается исключительно на информации таблицы маршрутизации. Маршрутизатор сравнивает IP-адрес назначения с маршрутами в таблице маршрутизации, чтобы найти наилучшее совпадение, а затем пересылает пакет на основе маршрута наилучшего совпадения. Этот же процесс можно использовать для фильтрации трафика с помощью списка управления доступом (ACL).

ACL-список — это ряд команд IOS, определяющих, пересылает ли маршрутизатор пакеты или сбрасывает их, исходя из информации в заголовке пакета. По умолчанию маршрутизатор не имеет настроенных списков ACL. Однако если ACL-список используется на интерфейсе, маршрутизатор выполняет дополнительную задачу, оценивая все сетевые пакеты, проходящие через интерфейс, с целью определения разрешения пересылки пакета.

Список контроля доступа (ACL) — это последовательный список разрешающих или запрещающих операторов, называемых записями списка контроля доступа (ACE).

**Примечание:** Записи контроля доступа также часто называют правилами ACL-списка.

При прохождении сетевого трафика через интерфейс, где действует список контроля доступа (ACL), маршрутизатор последовательно сопоставляет информацию из пакета с каждой записью в списке контроля доступа на предмет соответствия. Этот процесс называется фильтрацией пакетов.

Некоторые задачи, выполняемые маршрутизаторами, требуют использования списков ACL для идентификации трафика. В таблице перечислены некоторые из этих задач с примерами.

| Задача | Пример |
| --- | --- |
| Ограничение сетевого трафика для повышения производительности сети. | <ul><li>Корпоративная политика запрещает видеотрафик в сети для уменьшения сетевой нагрузки.</li><li>Политика может быть применена с помощью списков ACL для блокировки видеотрафика. </li></ul> |
| Управление потоком трафика. | <ul><li>Корпоративная политика требует ограничения трафика протокола маршрутизации только на определенные ссылки.</li><li>Политика может быть реализована с помощью списков ACL для ограничения доставки обновления маршрутизации только для тех, которые поступают из известного источника.</li></ul> |
| Списки контроля доступа обеспечивают базовый уровень безопасности в отношении доступа к сети. | <ul><li>Корпоративная политика требует, что доступ к сети управления персоналом быть ограничено только авторизованными пользователями.</li><li>Политика может быть применена с помощью списков ACL для ограничения доступа к указанным сетями.</li></ul> |
| Фильтрация трафика на основе типа трафика. | <ul><li>Корпоративная политика требует, чтобы трафик электронной почты был разрешен, но доступ к Telnet будет запрещен.</li><li>Политику можно реализовать с помощью списков ACL для фильтрации трафика по типу.</li></ul> |
| Проверка хостов в целях разрешения или запрета доступа к сетевым сервисам. | <ul><li>Корпоративная политика требует доступа к некоторым типам траика (например, FTP или HTTP) ограничены группами пользователей.</li><li>Политику можно реализовать с помощью списков ACL для фильтрации доступа пользователей к сервисам.</li></ul> |
| Предоставление приоритета определенным классам сетевого трафика | <ul><li>Корпоративный трафик указывает, что голосовой трафик перенаправляется так быстро насколько это возможно, чтобы избежать каких-либо перерывов.</li><li>Политика может быть реализована с помощью списков ACL и служб QoS для определения, что это голосовой трафик и необходимо немедленно его обработать.</li></ul> |

<!-- 4.1.2 -->
## Фильтрация пакетов

Фильтрация пакетов обеспечивает контроль доступа к сети на основе анализа входящих и исходящих пакетов с последующей переадресацией или отбрасыванием этих пакетов согласно заданным критериям. Как показано на рисунке, фильтрация пакетов может происходить на уровнях 3 и 4.

![](./assets/4.1.2.png)
<!-- /courses/ensa-dl/ae8e8c82-34fd-11eb-ba19-f1886492e0e4/aeb415e6-34fd-11eb-ba19-f1886492e0e4/assets/c6077f52-1c46-11ea-af56-e368b99e9723.svg -->

Маршрутизаторы Cisco поддерживают два типа списков ACL:

* **Стандартные списки ACL** - ACL фильтруют только на уровне 3, используя только адрес источника IPv4.
* **Расширенные списки ACL** - фильтр ACL на уровне 3 с использованием адреса IPv4 источника и/или назначения. Они также могут фильтровать на уровне 4, используя порты TCP, UDP и дополнительную информацию о типе протокола для более точного управления.

<!-- 4.1.3 -->
## Принцип работы списков контроля доступа

Списки контроля доступа определяют набор правил, обеспечивающих дополнительный контроль над пакетами, которые принимаются интерфейсами, транзитными пакетами, которые передаются через маршрутизатор, а также пакетами, которые отправляются из интерфейсов маршрутизатора.

Как показано на рисунке, можно настроить списки контроля доступа (ACL) для входящего и исходящего трафика.

![](./assets/4.1.3.png)
<!-- /courses/ensa-dl/ae8e8c82-34fd-11eb-ba19-f1886492e0e4/aeb415e6-34fd-11eb-ba19-f1886492e0e4/assets/c60842a1-1c46-11ea-af56-e368b99e9723.svg -->

**Примечание:** Списки контроля доступа не применяются к пакетам, созданным маршрутизатором.

Входящий ACL фильтрует пакеты, приходящие на определенный интерфейс, до того, как они будут направлены на исходящий интерфейс. Входящий ACL-список эффективен, поскольку он сохраняет ресурсы на поиск маршрута, если пакет сбрасывается. Если согласно списку контроля доступа (ACL) прохождение пакета следует разрешить, то этот пакет маршрутизируется. Входные списки контроля доступа (ACL) лучше всего подходят для случаев, когда единственным источником проверяемых пакетов является сеть, подключенная к входному интерфейсу.

Исходящий ACL фильтрует пакеты после их маршрутизации — вне зависимости от входящего интерфейса. Входящие ACL — входящие пакеты обрабатываются перед отправкой в выходной интерфейс. Исходящие ACL-списки лучше всего использовать, когда одинаковые фильтры применяются к пакетам, поступающим с множества входящих интерфейсов, перед выходом на тот же выходной интерфейс.

Когда ACL применяется к интерфейсу, он выполняет определенную рабочую процедуру. Например, ниже приведены действия, используемые при поступлении трафика в интерфейс маршрутизатора с настроенным входящим стандартным ACL IPv4.

1.  Если на маршрутизаторе настроен стандартный список контроля доступа (ACL) IPv4, то, получив пакет, такой маршрутизатор извлекает из заголовка пакета IPv4-адрес источника.
2.  Далее маршрутизатор последовательно сравнивает адрес с адресом в каждой из записей в списке контроля доступа (ACL), начиная с первой записи.
3.  Когда сопоставление установлено, маршрутизатор выполняет инструкцию, разрешающую или запрещающую пакет, а остальные ACE в ACL, если таковые имеются, не анализируются.
4.  Если исходный IPv4-адрес не совпадает ни с одним ACE в ACL, пакет отбрасывается, поскольку существует неявный запрет ACE, автоматически применяемый ко всем ACL.

Последней записью ACL-списка всегда является косвенный отказ, блокирующий весь трафик. По умолчанию эта инструкция автоматически подразумевается в конце списка ACL, даже если она скрыта и не отображается в конфигурации.

**Примечание:** ACL должен иметь по крайней мере одну инструкцию разрешения, иначе весь трафик будет отклонен из-за неявного оператора deny ACE.


